<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>팀 커뮤니티</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
</head>
<body>
<h1>팀 커뮤니티</h1>
<h4>인사팀만을 위한 공간입니다.</h4>

<h2>포스트 등록</h2>
<form name="insertPost" id="insertPost" enctype="application/x-www-form-urlencoded">
    <textarea name="postContent" id="postContent" cols="30" rows="10"></textarea> <br />
    <input type="file" name="postFile" id="postFile"><br />
    <button type="button" id="insertPostBtn">등록</button>
</form>
<hr /><br />
<h2>포스트 불러오기</h2>
<form>
    <table border="1" style="width: 80%;">
        <thead>
        <tr>
            <td>글번호</td>
            <td>사원 이름</td>
            <td>등록일</td>
            <td>포스트 내용</td>
            <td>좋아요</td>
            <td>댓글 수</td>
            <td>수정/삭제</td>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>1</td>
            <td>강서주</td>
            <td>2023/08/08 21:42:00</td>
            <td>Lorem ipsum dolor sit amet consectetur. In malesuada sed vitae pharetra id. Cras cong</td>
            <td>0</td>
            <td>0</td>
            <!-- 만약에 등록 사원 아이디와 로그인한 사원 아이디가 일치할 때 노출-->
            <td>
                <button type="button" id="modifyBtn">수정</button>
                <button type="button" id="deleteBtn">삭제</button>
            </td>
        </tr>
        </tbody>
    </table>
    <hr /><br />
    <h2>포스트에 등록한 댓글 불러오기</h2>
    <table border="1" style="width: 80%;">
        <thead>
        <tr>
            <td>글 번호</td>
            <td>댓글 번호</td>
            <td>댓글 내용</td>
            <td>댓글남긴 날짜</td>
            <td>댓글남긴 사원</td>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>1</td>
            <td>1</td>
            <td>Lorem ipsum dolor sit amet consectetur. In malesuada sed vitae pharetra id. Cras cong</td>
            <td>2023/08/27</td>
            <td>이혜진</td>
        </tr>
        <tr>
            <td>1</td>
            <td>2</td>
            <td>Lorem ipsum dolor sit amet consectetur. In malesuada sed vitae pharetra id. Cras cong</td>
            <td>2023/08/27</td>
            <td>이혜진</td>
        </tr>
        </tbody>
    </table>
</form>
<hr /><br />
<h2>투표 추가하기 <= 누르면 추가하기 모달 밑에 추가</h2>
<button type="button" id="addVote">투표 추가하기</button>
<div id="modal-insert-vote" style="display: none;">
    <form action="#">
        <label for="voteRegistTitle">투표 제목</label> <br />
        <input type="text" name="voteRegistTitle" id="voteRegistTitle"> <br />
        <label for="insertOption">옵션 추가</label>
        <button type="button" id="insertOption">옵션 추가 +</button>
        <div class="options">
            <div class="option">
                <input type="text" name="voteOption1" id="voteOption1">
                <label for="voteOption1"></label>
            </div>
            <div class="option">
                <input type="text" name="voteOption2" id="voteOption2">
                <label for="voteOption2"></label>
            </div>
        </div>
        <label for="voteRegistStartDate">시작날짜</label>
        <input type="date" name="voteRegistStartDate" id="voteRegistStartDate">
        <label for="voteRegistEndDate">마감날짜</label>
        <input type="date" name="voteRegistEndDate" id="voteRegistEndDate"> <br />
        <button type="button" id="insertVote">투표 등록</button>
    </form>
</div>
<br /><hr />
<h2>진행중인 투표</h2>
<table border="1" style="width: 50%;" class="voteRegistId">
    <thead>
    <tr>
        <th>투표등록 번호 </th>
        <td>
            <input type="text" name="vote1"  value="VOTE_REGIST_SEQ 값" style="width: 90%;" readonly> </td> <!-- name -> VOTE_REGIST_SEQ -->
    </tr>
    <tr>
        <th>투표 제목</th>
        <td> <input type="text" name="vote1RegistTitle" class="vote1RegistTitle" value="회식 뭐먹을까요?"  style="width: 90%;" readonly> </td>
    </tr>
    <tr>
        <th>투표 시작일 </th>
        <td>
            <input type="text" name="vote1RegistStartDate" class="voteRegistStartDate" value="2023-08-23"  style="width: 90%;" readonly>
        </td>
    </tr>
    <tr>
        <th>투표 종료일 </th>
        <td>
            <input type="text" name="vote1RegistEndtDate" class="vote1RegistEndtDate" value="2023-08-28"  style="width: 90%;" readonly>
        </td>
    </tr>
    <tr>
        <th>투표 등록 사원 아이디 </th>
        <td>
            <input type="text" name="vote1RegistEmpId" class="vote1RegistEmpId" value="20230827"  style="width: 90%;" readonly>
        </td>
    </tr>
    <!-- 만약에 등록 사원 아이디와 로그인한 사원 아이디가 일치할 때 노출-->
    <tr>
        <th>등록 사원 아이디와 로그인 아이디가 일치할 때 노출 =></th>
        <td>
            <button type="button" class="modifyVote">수정</button>
            <button type="button" class="deleteVote">삭제</button>
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <!-- input name에 투표 항목 번호가 들어오게  -->
        <td>등록된 옵션</td>
        <td><input type="radio" name="voteRegist1" readonly checked>
            <label for="1">삼겹살</label>
            <input type="radio" name="voteRegist1" id="1" readonly>
            <label for="2">마라탕</label>
            <input type="radio" name="voteRegist1" id="2" readonly>
            <label for="3">찐옥수수</label>
            <input type="radio" name="voteRegist1" id="3" readonly>
            <label for="4">곱창</label></td>
            <input type="radio" name="voteRegist1" id="4" readonly>
    </tr>
    <tr>
        <td>투표 인원 수</td>
        <td>
            <ul>
                <li>삼겹살 : 1 (명)</li>
                <li>마라탕 : 1 (명)</li>
                <li>찐옥수수 : 2 (명)</li>
                <li>곱창 : 4 (명)</li>
            </ul>
        </td>
    </tr>

    </tbody>
</table>
<!--<div id="editVoteModal" class="modal" style="display: none">
    <div class="modal-content">
        <h3>수정 모달창</h3>
        <form action="#">
            <label for="voteRegistTitle">투표 제목</label> <br />
            <input type="text" name="voteRegistTitle" id="voteRegistTitle"> <br />
            <label for="insertOption">옵션 추가</label>
            <button type="button" id="insertOption">옵션 추가 +</button>
            <div class="options">
                <div class="option">
                    <input type="text" name="voteOption1" id="voteOption1">
                    <label for="voteOption1"></label>
                </div>
                <div class="option">
                    <input type="text" name="voteOption2" id="voteOption2">
                    <label for="voteOption2"></label>
                </div>
            </div>
            <label for="startVodeDate">시작날짜</label>
            <input type="date" name="voteRegistStartDate" id="voteRegistStartDate">
            <label for="endVodeDate">마감날짜</label>
            <input type="date" name="voteRegistEndDate" id="voteRegistEndDate"> <br />
            <button type="button" id="insertVote">투표 등록</button>
        </form>
    </div>
</div>-->
<br /><hr />
<h2>팀 공지</h2>
<button type="button" id="addTeamNotice">팀 공지 추가하기</button>
<div id="modal-insert-notice" style="display: none;">
    <form action="#" enctype="application/x-www-form-urlencoded">
        <label for="emplId">글쓴이</label> <br />
        <input type="text" name="emplId" id="emplId"> <br />
        <label for="sntncSj">공지 제목</label> <br />
        <input type="text" name="sntncSj" id="sntncSj"> <br />
        <label for="sntncCn">공지 내용</label><br />
        <input type="file" name="noticeFile" id="noticeFile"><br />
        <textarea name="sntncCn" id="sntncCn" cols="30" rows="10"></textarea><br />
        <button type="button" id="insertNotice">등록</button>
    </form>
</div>
<br /><hr />
<script>
    document.addEventListener("DOMContentLoaded", () => {
        const addVoteBtn = document.querySelector("#addVote");
        const postInput = document.querySelector("#postContent");
        const fileInput = document.querySelector("#postFile");
        const voteTitle = document.querySelector("#voteRegistTitle");
        const insertPostBtn = document.querySelector("#insertPost");
        const insertOptionBtn = document.querySelector("#insertOption");
        const insertVoteBtn = document.querySelector("#insertPostBtn");
        const voteRegistStartDate = document.querySelector("#voteRegistStartDate");
        const sntncSj = document.querySelector("#sntncSj");
        const sntncCn = document.querySelector("#sntncCn");
        const insertNotice = document.querySelector("#insertNotice");
        const noticeFile = document.querySelector("#noticeFile");
        const modifyVoteBtn = document.querySelector("#modifyVote");
        const deleteVoteBtn = document.querySelector("#deleteVoteBtn");
        let formData = undefined;

        let selectedFile = undefined;
        let num = 2;


        insertPostBtn.addEventListener("click", () => {
            const postCont = postInput.value;
            formData = new FormData();
            formData.append("postCont", postCont);

            selectedFile = fileInput.files[0];
            formData.append("file", selectedFile);


            /* $.ajax({
                type : "post",
                // url 적어주세요
                url : "#",
                data : formData,
                processData: false,
                contentType: false,
                dataType : "text",
                contentType : "application/json;charset-utf-8",
                success : function(rslt){
                    console.log("결과 확인 : "+ rslt);
                },
                error: function (xhr, status, error) {
                    console.log("code: " + xhr.status)
                    console.log("message: " + xhr.responseText)
                    console.log("error: " + error);
                }
            }) */


        })

        addVoteBtn.addEventListener("click", () => {
            document.querySelector("#modal-insert-vote").style.display = "block";
        })
        insertVoteBtn.addEventListener("click", () => {
            const voteVO = {
                "voteRegistTitle" : voteTitle.value,
                "voteRegistStartDate" : voteRegistStartDate.value,
                "voteRegistEndDate" : voteRegistEndDate.value
            }
            // 알아서 쓰시오
            /* $.ajax({

            }) */
            document.querySelector("#modal-insert-vote").style.display = "none";
        })
        insertOptionBtn.addEventListener("click",() => {
            const optionContainer = document.querySelector(".option");
            const options = document.querySelector(".options");
            let optionContainers = document.querySelectorAll(".option");
            console.log(optionContainers.length + 1);
            if(optionContainers.length + 1 > 5) {
                alert("옵션은 5개까지 가능합니다.")
                return;
            }
            num++;
            let newDiv = document.createElement("div");
            newDiv.className = "option";

            const newInput = document.createElement("input");
            newInput.type = "text";
            newInput.name = num;
            newInput.id = num;

            const newLabel = document.createElement("label");
            newLabel.htmlFor = newInput.id;
            newLabel.textContent = "";

            newDiv.appendChild(newInput);
            newDiv.appendChild(newLabel);

            options.appendChild(newDiv);
        })
        insertNotice.addEventListener("click",()=>{
            const noticeTitle = sntncSj.value;
            const noticeContent = sntncCn.value;
            formData = new FormData();
            formData.append("noticeTitle", noticeTitle);
            formData.append("noticeContent", noticeContent);

            selectedFile = noticeFile.files[0];
            formData.append("file", selectedFile);

            if(noticeTitle == "" ||noticeContent == ""){
                alert("모든 항목을 입력해주세요.")
                return;
            }

            /* $.ajax({
                // 입력하세요.
            }) */
            document.querySelector("#modal-insert-notice").style.display = "none";
        })

        /*  const getVoteList = () => {
            $.ajax({
                type: "get",
                // url: "",
                dataType: "json",
                success: function (res) {
                    console.log("체크 : ",res);
                    //form 에 class voteModifyForm 넣어주세용
                },
                error: function (xhr, status, error) {
                    console.log("code: " + xhr.status);
                    console.log("message: " + xhr.responseText);
                    console.log("error: " + error);
                }
            });
        }
        getVoteList(); */

        const forms = document.querySelectorAll('.voteRegistId');
        forms.forEach(form => {
            console.log(form);
            const modifyVoteBtn = document.querySelector(".modifyVote");

            form.addEventListener("click", function(event) {
                console.log(event.target)
                if (event.target === modifyVoteBtn) {
                    if (form.style.display != "none") {
                        form.style.display = "none";
                        document.querySelector(".modifyRegist").style.display = "block";
                    }
                }
            });
        })

        /* updateVoteBtn.addEventListener("click",() => {

        }) */
        document.querySelector("#addTeamNotice").addEventListener("click",() => {
            document.querySelector("#modal-insert-notice").style.display = "block";
        })
    })
</script>
</body>
</html>