<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.groovy.common.CommonMapper">
    <select id="loadNoticeList" parameterType="String" resultType="noticeVO">
        SELECT NOTI_SEQ,
               NOTI_TITLE,
               NOTI_CONTENT,
               NOTI_DATE,
               NOTI_RDCNT,
               NOTI_CTGRY_ICON_FILE_STRE_NM,
               COMMON_CODE_ESSNTL_REDNG
        FROM NOTI

    </select>
    <select id="findNotice" parameterType="map" resultType="noticeVO">
        SELECT
        NOTI_SEQ,
        NOTI_TITLE,
        NOTI_CONTENT,
        NOTI_DATE,
        NOTI_RDCNT,
        NOTI_CTGRY_ICON_FILE_STRE_NM,
        COMMON_CODE_ESSNTL_REDNG
        FROM NOTI
        WHERE 1 = 1
        <if test="keyword!=null and keyword!=''">
            AND (
            NOTI_TITLE LIKE '%' || #{keyword} || '%' OR
            NOTI_CONTENT LIKE '%' || #{keyword} || '%'
            )
        </if>
        <if test="sortBy!=null and sortBy!=''">
            ORDER BY NOTI_DATE ${sortBy}
        </if>
    </select>
    <select id="loadNoticeDetail" parameterType="int" resultType="noticeVO">
            SELECT NOTI_SEQ,
                   NOTI_TITLE,
                   NOTI_CONTENT,
                   NOTI_DATE,
                   NOTI_RDCNT,
                   NOTI_CTGRY_ICON_FILE_STRE_NM,
                   COMMON_CODE_ESSNTL_REDNG
            FROM NOTI
            WHERE NOTI_SEQ = #{notiSeq}
    </select>
    <update id="modifyNoticeView" parameterType="int">
        UPDATE NOTI SET NOTI_RDCNT=NOTI_RDCNT + 1 WHERE NOTI_SEQ = #{notiSeq}
    </update>
    <select id="loadOrgChart" parameterType="String" resultType="employeeVO">
        SELECT E.EMPL_ID,
               E.EMPL_NM,
               E.EMPL_EMAIL,
               E.COMMON_CODE_DEPT,
               E.COMMON_CODE_CLSF,
               P.PROFL_PHOTO_FILE_STRE_NM
        FROM EMPL E,
             PROFL P
        WHERE E.EMPL_ID = PROFL_EMPL_ID AND
            E.COMMON_CODE_DEPT = #{depCode}
    </select>
</mapper>